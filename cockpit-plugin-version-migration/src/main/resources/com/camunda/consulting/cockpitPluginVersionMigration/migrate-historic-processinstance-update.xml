<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cockpit.version-migration">

  <update id="updateHistoricProcessInstance" parameterType="com.camunda.consulting.cockpitPluginVersionMigration.dto.HistoricProcessInstanceDto">
    update ${prefix}ACT_HI_PROCINST set
      PROC_DEF_ID_ = #{processDefinitionId, jdbcType=VARCHAR}
    where ID_ = #{id, jdbcType=VARCHAR}
  </update>
  
  <resultMap id="processInstanceMap" type="com.camunda.consulting.cockpitPluginVersionMigration.dto.ProcessInstanceDto">
    <result property="processDefinitionId" column="processDefinitionId_" jdbcType="VARCHAR" />
  </resultMap>

  <select id="getProcessDefinition" resultMap="processInstanceMap" parameterType="com.camunda.consulting.cockpitPluginVersionMigration.dto.ProcessInstanceDto">
    select processdefinitionId_ 
    from ${prefix}ACT_RU_EXECUTION
    where processInstanceId_ = #{processInstanceId, jdbcType=VARCHAR} 
    and executionId_ = #{processInstanceId, jdbcType=VARCHAR} 
  </select>

</mapper>